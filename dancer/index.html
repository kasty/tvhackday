<!doctype html>
<html lang="en">
<head>
    <title>SoundManager 2: JavaScript Sound For The Web</title>
    <meta name="robots" content="noindex" />
    <meta name="description" content="Play sound from JavaScript including MP3, MPEG-4 and HTML5-supported audio formats with SoundManager 2, a cross-browser/platform sound API. BSD licensed."/>
    <meta name="keywords" content="javascript sound, html5 audio, html5 sound, javascript audio, javascript play mp3, javascript sound control, mp3, mp4, mpeg4, aac, Scott Schiller, Schill, Schillmania"/>
    <meta name="author" content="Scott Schiller"/>
    <meta name="dcterms.rights" content="Copyright (C) 1997 onwards Scott Schiller"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

<!-- inline demo CSS (combined + minified for performance; see comments for raw source URLs) -->
<!-- the SoundManager 2 API -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script> 
<script src="http://www.arte.tv/arte_vp/js/main.js"></script><!--<script type="text/javascript" src="script/soundmanager2-nodebug-jsmin.js"></script>-->
<script type="text/javascript" src="bower_components/dancer.js/dancer.min.js"></script>
    <script src="bower_components/easeljs/lib/easeljs-0.7.1.min.js"></script>
    <script src="bower_components/TweenJS/lib/tweenjs-0.5.1.min.js"></script>
    <script src="bower_components/randomColor/randomColor.js"></script>

</head>

<script>
document.domain = "arte.tv";
var player;
var hasAlreadyPaused = false;
var dancer = new Dancer();

<body>

    <canvas id="arteConcert">
    </canvas>

    <script type="text/javascript">
        // Params
        var canvas = document.getElementById("arteConcert");
        var Ease = createjs.Ease;
        var Tween = createjs.Tween;
        var circleRadius = 40;
        var trackWidth = window.innerWidth/3;

        // Canvas & stage
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        stage = new createjs.Stage(canvas);

        // Lines
        createLine(1);
        createLine(2);

        // Functions
        function createCircle(trackNumber, color) {
            var circle = new createjs.Shape();
            circle.graphics.beginFill(color).drawCircle(0, 0, circleRadius);
            circle.x = trackWidth*trackNumber;
            circle.y = 0-circleRadius;
            Tween.get(circle).to({y:canvas.height+circleRadius}, 1000, Ease.linear);
            stage.addChild(circle);
        }

        function createLine(trackNumber) {
            var line = new createjs.Shape();
            line.graphics.setStrokeStyle(10);
            line.graphics.beginStroke("#EEE");
            line.graphics.moveTo(trackWidth*trackNumber, 0);
            line.graphics.lineTo(trackWidth*trackNumber, window.innerHeight);
            line.graphics.endStroke();
            stage.addChild(line);
        }

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            stage.update();
        }

        // Events
        window.addEventListener('resize', resize, false);

        // FPS & render loop
        createjs.Ticker.setFPS(60);
        createjs.Ticker.addEventListener('tick', function() {
            stage.update();
            // console.log(createjs.Ticker.getMeasuredFPS());
        });
$(window).load(function() {
	//listen to the arte_vp_player_config_ready event
	$('.video-container').on('arte_vp_player_ready',function() {

		var playerDomElement = $(this).find('iframe')[0].contentWindow.$('div#player_container');
		arte_vp = $(this).find('iframe')[0].contentWindow.arte_vp;
				
		$(this).find('iframe')[0].contentWindow.arte_vp.jwplayer.onPlay(function(event){
			
			if(hasAlreadyPaused == false)
			{
				var self = this;
		
				arte_vp.jwplayer.pause();
				setTimeout(function(){
				
					hasAlreadyPaused = true;
					self.play(true);
				
				},1000);
		
				dancer.load({src:arte_vp.arte_vp_sources[2].file});
				dancer.play();
				dancer.audio.volume = 0;
				
				kick = dancer.createKick({
					threshold:0.05,
					decay:0.03,
					onKick: function ( mag ) {
					var color = randomColor();
                createCircle(1, color);
                createCircle(2, color);					},
					offKick: function ( mag ) {
						//console.log('no kick :(');
					}
				});

				// Let's turn this kick on right away
				kick.on();
			}
		});
	
	});
});
</script>
<body>
<div style="width:720px;height:406px;background:black;position:relative;" class="video-container" arte_vp_config="arte_concert" arte_vp_lang="fr_FR" arte_vp_url="http://concert.arte.tv/fr/player/27446" arte_vp_autostart="1"></div>
</body>
</html>
